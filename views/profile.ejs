<% layout('layouts/boilerplate') -%>
<img
    src="<%= currentUser.image.secure_url %>"
    alt="<%= currentUser.username %>'s avatar"
    class="profile-image"
/>
<h1><%= currentUser.username %>'s Profile</h1>
<p>Recents Post:</p>
<% posts.forEach((post)=>{ %>
<div>
    <a href="/posts/<%= post.id %>"><%= post.title %></a>
</div>
<% }) %>

<p>Update Info</p>
<form action="/profile?_method=PUT" method="POST" enctype="multipart/form-data">
    <div>
        <label for="username">Username</label>
        <input
            type="text"
            name="username"
            id="username"
            value="<%= currentUser.username %>"
            autofocus
            required
        />
    </div>
    <div>
        <label for="current-password">Current Password *</label>
        <input
            type="password"
            id="current-password"
            name="currentPassword"
            required
        />
    </div>
    <div>
        <label for="new-password">New Password</label>
        <input type="password" id="new-password" name="newPassword" />
    </div>
    <div>
        <label for="password-confirmation">Confirm Password</label>
        <input
            type="password"
            id="password-confirmation"
            name="passwordConfirmation"
        />
    </div>
    <div id="validation-message"></div>
    <div>
        <label for="email">Email</label>
        <input
            type="text"
            id="email"
            name="email"
            value="<%= currentUser.email %>"
        />
    </div>
    <div>
        <label for="image">Avatar</label>
        <small>(this deletes existing Avatar)</small>
        <input type="file" id="image" name="image" />
    </div>

    <input type="submit" id="update-profile" />
</form>

<script src="/javascripts/profile.js"></script>
